{% extends "base.html" %}

{% block title %}Lojas — Cadastro{% endblock %}

{% block content %}
  <div class="flex items-center justify-between mb-4">
    <div>
      <h1 class="text-xl font-semibold">Lojas</h1>
      <div class="text-sm text-slate-600">Cadastro mestre de lojas.</div>
    </div>

    <a href="{% url 'registry:loja_create' %}" class="rounded-lg bg-slate-900 text-white px-4 py-2 hover:bg-slate-800 text-sm">
      Nova loja
    </a>
  </div>

  <div class="flex items-center justify-between mb-3">
    <div class="text-sm text-slate-600">
      {% if page_obj %}
        Mostrando {{ page_obj.start_index }}–{{ page_obj.end_index }} de {{ page_obj.paginator.count }} lojas
      {% endif %}
    </div>

    <div class="flex items-center gap-2">
      <span class="text-sm text-slate-600">Itens por página:</span>
      <a class="text-sm px-2 py-1 border rounded-lg hover:bg-slate-50 {% if request.GET.per_page == '10' %}bg-slate-100{% endif %}"
         href="?per_page=10">10</a>
      <a class="text-sm px-2 py-1 border rounded-lg hover:bg-slate-50 {% if request.GET.per_page == '25' or not request.GET.per_page %}bg-slate-100{% endif %}"
         href="?per_page=25">25</a>
      <a class="text-sm px-2 py-1 border rounded-lg hover:bg-slate-50 {% if request.GET.per_page == '50' %}bg-slate-100{% endif %}"
         href="?per_page=50">50</a>
      <a class="text-sm px-2 py-1 border rounded-lg hover:bg-slate-50 {% if request.GET.per_page == '100' %}bg-slate-100{% endif %}"
         href="?per_page=100">100</a>
      <a class="text-sm px-2 py-1 border rounded-lg hover:bg-slate-50 {% if request.GET.per_page == 'all' %}bg-slate-100{% endif %}"
         href="?per_page=all">Tudo</a>
    </div>
  </div>

  <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-5">
    <table class="min-w-full text-sm">

    <thead>
      <tr class="text-left text-slate-600 border-b border-slate-200">
        <th class="py-3 pr-4">Java</th>
        <th class="py-3 pr-4">Hist.</th>
        <th class="py-3 pr-4">Nome loja</th>
        <th class="py-3 pr-4">Endereço</th>
        <th class="py-3 pr-4">Logomarca</th>
        <th class="py-3 pr-4">Cidade/UF</th>
        <th class="py-3 pr-4">Telefone</th>
        <th class="py-3 pr-4">IP Banco 12</th>
        <th class="py-3 pr-4"></th>
      </tr>
    </thead>

    <tbody class="divide-y divide-slate-100">
      {% for loja in lojas %}
        <tr class="hover:bg-slate-50">
          <td class="py-3 pr-4 font-medium">{{ loja.codigo }}</td>
          <td class="py-3 pr-4">{{ loja.hist }}</td>
          <td class="py-3 pr-4">{{ loja.nome }}</td>

          <td class="py-3 pr-4 max-w-md truncate" title="{{ loja.endereco }}">
            {{ loja.endereco }}
          </td>

          <td class="py-3 pr-4">{{ loja.logomarca }}</td>

          <td class="py-3 pr-4">
            {% if loja.cidade %}{{ loja.cidade }}{% endif %}{% if loja.uf %}/{{ loja.uf }}{% endif %}
          </td>

          <td class="py-3 pr-4">{{ loja.telefone }}</td>

          <td class="py-3 pr-4">
            {{ loja.ip_banco_12|default_if_none:"" }}
          </td>

          <td class="py-3 pr-4 text-right">
            <a href="{% url 'registry:loja_update' loja.pk %}" class="text-sm text-slate-600 hover:underline">
              Editar
            </a>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="9" class="py-6 text-slate-500 text-center">Nenhuma loja cadastrada.</td>
        </tr>
      {% endfor %}
    </tbody>

    </table>

    {% if is_paginated %}
      <div class="mt-4 flex items-center justify-between">
        <div class="text-sm text-slate-600">
          Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
        </div>

        <div class="flex gap-2">
          {% if page_obj.has_previous %}
            <a class="px-3 py-1 border rounded-lg hover:bg-slate-50 text-sm"
               href="?per_page={{ request.GET.per_page|default:'25' }}&page={{ page_obj.previous_page_number }}">
              Anterior
            </a>
          {% endif %}

          {% if page_obj.has_next %}
            <a class="px-3 py-1 border rounded-lg hover:bg-slate-50 text-sm"
               href="?per_page={{ request.GET.per_page|default:'25' }}&page={{ page_obj.next_page_number }}">
              Próxima
            </a>
          {% endif %}
        </div>
      </div>
    {% endif %}
  </div>
{% endblock %}